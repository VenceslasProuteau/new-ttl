(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{36:function(e,t,n){},67:function(e,t,n){},69:function(e,t,n){},75:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),r=n(37),c=n.n(r),i=n(14),o=n(3),l=n(5),d=n(6),u=n(8),j=n(7),m=n(22),h=n.n(m),b=n(4),O=n(19),g=n.n(O),p=n(38),v=n.n(p);var f=new function(){return{getAuthToken:function(){return g.a.get("authToken")}}};var _=new function(e){return{call:function(e){return v()(Object(o.a)(Object(o.a)({},e),{},{url:"".concat("/api/v1").concat(e.url),method:e.method||"GET"})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}))},callAuth:function(t){var n=e.getAuthToken();return n?this.call(Object(o.a)(Object(o.a)({},t),{},{headers:Object(o.a)(Object(o.a)({},t.headers),{},{token:n})})):Promise.reject({reason:"NOT_AUTHENTICATED"})}}}(f);var x=new function(e){return{login:function(t){return e.call({method:"POST",url:"/user/login",data:t})},signUp:function(t){return e.call({method:"POST",url:"/user/signup",data:t})}}}(_),N="authToken",k=function(){function e(){Object(l.a)(this,e),this.clientCache={}}return Object(d.a)(e,[{key:"get",value:function(){return this.clientCache}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.clientCache=Object(o.a)(Object(o.a)({},this.clientCache),e)}},{key:"reset",value:function(){this.clientCache={}}}]),e}();var y=new function(e){var t=new k;return{getDomain:function(){window.location.hostname.split(".").slice(-2).join(".")},logout:function(){var e=this.getDomain();g.a.remove(N,{domain:e}),t.reset()},login:function(t){var n=this;return e.login(t).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data.token;g.a.set(N,t,{expires:30,domain:n.getDomain()})})).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.response.data;return Promise.reject(t)}))},signUp:function(t){return e.signUp(t).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.response.data;return Promise.reject(t)}))},isAuthenticated:function(){return!!g.a.get(N)}}}(x),S=n(17);var w=new function(e){return{getSelfUser:function(){return e.callAuth({method:"GET",url:"/user/me"})}}}(_),L=n(15),C=n.n(L);function E(){var e;try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(t){return!1}}function T(e){if(E())return window.localStorage.removeItem(e)}function A(e){if(E())return function(e){if(void 0!==e)try{return JSON.parse(e)}catch(t){return null}}(localStorage.getItem(e))}var M=function(e,t){return function(e,t){if(void 0===t)return T(e);E()&&window.localStorage.setItem(e,JSON.stringify(t))}(e,t)},D=function(e){return A(e)},I=function(){function e(t){Object(l.a)(this,e),this.id=t,this.store=D(this.id)||{}}return Object(d.a)(e,[{key:"get",value:function(){var e=C.a.isEmpty(this.store)?D(this.id):this.store;return this.store=e,Object(o.a)({},this.store)}},{key:"set",value:function(e,t){this.store=Object(o.a)(Object(o.a)({},this.store),e),t&&M(this.id,this.store)}},{key:"reset",value:function(){this.store={},M(this.id,this.store)}}]),e}();var U=new function(e){var t=new I("SELF_USER");return{getSelfUser:function(){var n=t.get().user;return n?Promise.resolve(n):e.getSelfUser().then((function(e){return console.log("user",e),t.set({user:e}),e}))}}}(w),R=(n(67),n(0)),P=function(){return Object(R.jsx)("div",{className:"spinner-container",children:Object(R.jsx)("div",{className:"spinner"})})},G=(n(69),function(e){return function(t){Object(u.a)(a,t);var n=Object(j.a)(a);function a(e){var t;return Object(l.a)(this,a),(t=n.call(this,e)).state={isLoading:!1},t}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;return y.isAuthenticated()?(this.setState({isLoading:!0}),U.getSelfUser().then((function(t){return e.setState({isLoading:!1,user:t})}))):(this.props.history.replace({pathname:de.LOGIN.path,search:"?redirectUrl=".concat(this.props.location.pathname)}),null)}},{key:"render",value:function(){return this.state.isLoading?Object(R.jsx)(P,{}):Object(R.jsx)(e,Object(o.a)(Object(o.a)({},this.props),{},{user:this.state.user}))}}]),a}(s.a.Component)}),H=n(42),q=n(39),B=n(18);var F=new function(){var e=new I("SCHEDULE");return{getSchedule:function(t){var n=t.replace(/-/gi,""),a=C.a.get(e.get().schedule,n);return a?Promise.resolve(a):function(e){return _.call({url:"/schedule/".concat(e)}).then((function(e){return e.data})).catch((function(e){return e}))}(t).then((function(t){return e.set({schedule:Object(B.a)({},n,t)}),t}))}}},J="/decks",V={HOME:"".concat(J),SELECTION:"".concat(J,"/:date/:gameId")},z=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(l.a)(this,n),a=t.call(this,e),console.log("props",e),a.state={isLoading:!0,currentDate:Object(H.a)(Date.now(),"yyyy-MM-dd")},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;return F.getSchedule(this.state.currentDate).then((function(t){console.log("games",t),e.setState({isLoading:!1,games:t})})).catch((function(e){return console.log("e",e)}))}},{key:"selectGame",value:function(e){return this.props.history.push(Object(q.reverse)(V.SELECTION,{gameId:e,date:this.state.currentDate}))}},{key:"render",value:function(){var e=this;return this.state.isLoading?Object(R.jsx)(P,{}):Object(R.jsx)("div",{className:"decks__games-card",children:this.state.games.map((function(t){var n=t.awayTeam,a=t.homeTeam,s=t.id,r=t.date;return Object(R.jsxs)("div",{className:"decks__game-card",onClick:function(){return e.selectGame(s)},children:[Object(R.jsx)("div",{className:"decks__game-arena",children:Object(R.jsx)("span",{children:r})}),Object(R.jsxs)("div",{className:"decks__game-card-wrapper",children:[Object(R.jsxs)("div",{className:"decks__game-card-col",children:[Object(R.jsx)("span",{className:"decks__game-card-team",children:a.fullName}),Object(R.jsx)("div",{className:"decks__game-card-logo",children:Object(R.jsx)("img",{src:a.logo})})]}),Object(R.jsx)("div",{className:"decks__game-card-middle",children:"VS"}),Object(R.jsxs)("div",{className:"decks__game-card-col",children:[Object(R.jsx)("div",{className:"decks__game-card-logo",children:Object(R.jsx)("img",{src:n.logo})}),Object(R.jsx)("span",{className:"decks__game-card-team",children:n.fullName})]})]})]},s)}))})}}]),n}(s.a.Component),X=n(43);var K=new function(){var e=new I("PLAYERS");return{get:function(t){var n=C.a.get(e.get().players,t);return n?Promise.resolve(n):function(e){return _.call({url:"/players/".concat(e)}).then((function(e){return e.data})).catch((function(e){return e}))}(t).then((function(n){return e.set({players:Object(B.a)({},t,n)}),n}))}}},W=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={isLoading:!0},a.params=e.match.params,a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;return F.getSchedule(this.params.date).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=C.a.find(t,{id:parseInt(e.params.gameId,10)}),a=C.a.map([n.homeTeam,n.awayTeam],(function(e){var t=e.key;return K.get(t)}));return Promise.all(a).then((function(t){var a=Object(X.a)(t,2),s=a[0],r=a[1];return e.setState({homePlayers:s,awayPlayers:r,currentGame:n,isLoading:!1})}))}))}},{key:"render",value:function(){return this.state.isLoading?Object(R.jsx)("div",{children:"isLoading ..."}):Object(R.jsxs)("div",{className:"decks__selection",children:[Object(R.jsxs)("div",{className:"decks__game-card",children:[Object(R.jsx)("div",{className:"decks__game-arena",children:Object(R.jsx)("span",{children:this.state.currentGame.date})}),Object(R.jsxs)("div",{className:"decks__game-card-wrapper",children:[Object(R.jsxs)("div",{className:"decks__game-card-col",children:[Object(R.jsx)("span",{children:this.state.currentGame.homeTeam.fullName}),Object(R.jsx)("div",{className:"decks__game-card-logo",children:Object(R.jsx)("img",{src:this.state.currentGame.homeTeam.logo})})]}),Object(R.jsx)("div",{className:"decks__game-card-middle",children:"VS"}),Object(R.jsxs)("div",{className:"decks__game-card-col",children:[Object(R.jsx)("div",{className:"decks__game-card-logo",children:Object(R.jsx)("img",{src:this.state.currentGame.awayTeam.logo})}),Object(R.jsx)("span",{children:this.state.currentGame.awayTeam.fullName})]})]})]}),Object(R.jsxs)("div",{className:"decks__players",children:[Object(R.jsx)("div",{className:"decks__players-col",children:this.state.homePlayers.map((function(e){var t=e.name,n=e.pictureUrl;return Object(R.jsxs)("div",{className:"decks__player-card",children:[Object(R.jsx)("div",{className:"decks__player-card__name",children:t}),Object(R.jsx)("div",{className:"decks__player-card__picture",children:Object(R.jsx)("img",{src:n})})]})}))}),Object(R.jsx)("div",{className:"decks__players-col",children:this.state.awayPlayers.map((function(e){var t=e.name,n=e.pictureUrl;return Object(R.jsxs)("div",{className:"decks__player-card",children:[Object(R.jsx)("div",{className:"decks__player-card__name",children:t}),Object(R.jsx)("div",{className:"decks__player-card__picture",children:Object(R.jsx)("img",{src:n})})]})}))})]})]})}}]),n}(s.a.Component),Y={HOME:{path:V.HOME,exact:!0,component:Object(b.e)(z)},SELECTION:{path:V.SELECTION,component:Object(b.e)(W)}},Q=(n(75),n(16)),Z=n(41),$=n.n(Z),ee=(n(77),function(e){var t=e.name,n=void 0===t?[]:t,a=e.when,s=void 0===a?[]:a,r=e.message,c=void 0===r?"":r;return Object(R.jsx)(Q.a,{name:n,subscription:{submitFailed:!0,error:!0,active:!0},render:function(e){var t=e.meta,n=t.submitFailed,a=t.error;return!t.active&&n&&a&&(!s||s.indexOf(a)>=0)?Object(R.jsx)("span",{className:"form-error-message",children:c||a}):null}})}),te=/.+@.+\..+/,ne=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){return t||n(e)}),void 0)}},ae=function(e){return e?void 0:"required"},se=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new RegExp(e).test(t)?void 0:"pattern"}},re=function(e){return e.length<9?"passwordLength":void 0},ce=(n(36),{NOT_EXISTING_USER:"L'email renseign\xe9 n'existe pas",INVALID_PASSWORD:"Le mot de passe renseign\xe9 est incorrect"}),ie=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).redirectUrl=$.a.parse(e.location.search).redirectUrl,a.onLogin=a.onLogin.bind(Object(S.a)(a)),a.state={error:!1},a}return Object(d.a)(n,[{key:"onLogin",value:function(e){var t=this;return this.setState({isLoading:!0}),y.login(e).then((function(){if(!t.redirectUrl)return t.props.history.replace(de.DASHBOARD.path);window.location.href="".concat(window.location.origin).concat(t.redirectUrl)})).catch((function(e){var n=e.error;return t.setState({error:n,isLoading:!1})}))}},{key:"render",value:function(){var e=this;return this.state.isLoading?Object(R.jsx)(P,{}):Object(R.jsx)("div",{className:"authent-page",children:Object(R.jsx)("div",{className:"authent-page__form-container",children:Object(R.jsx)(Q.b,{onSubmit:this.onLogin,render:function(t){var n=t.handleSubmit;return Object(R.jsxs)("form",{onSubmit:n,autoComplete:"off",children:[Object(R.jsx)(Q.a,{name:"email",validate:ne(ae,se(te)),children:function(e){var t=e.input;return Object(R.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"email",placeholder:"Email",name:"email"}))}}),Object(R.jsx)(Q.a,{name:"password",validate:ne(ae),children:function(e){var t=e.input;return Object(R.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"password",placeholder:"Mot de passe",name:"password"}))}}),Object(R.jsxs)("div",{className:"form-error-message",children:[Object(R.jsx)(ee,{name:"email",when:["required"],message:"L'email est requis"}),Object(R.jsx)(ee,{name:"email",when:["pattern"],message:"Le format de l'email renseign\xe9 est incorrect"}),Object(R.jsx)(ee,{name:"password",when:["required"],message:"Le mot de passe est requis"}),e.state.error&&Object(R.jsx)("span",{children:ce[e.state.error]})]}),Object(R.jsx)("button",{className:"button",type:"submit",children:"Se connecter"}),Object(R.jsxs)("div",{className:"authent-page__signup",children:["Vous n'avez pas encore de compte ? ",Object(R.jsx)(i.b,{to:"/signup",className:"page__inlined-link",children:"Rejoignez notre communaut\xe9 d\xe8s maintenant !"})]})]})}})})})}}]),n}(a.Component),oe={USER_EXISTING:"Un compte est d\xe9j\xe0 enregistr\xe9 avec cet email",TECHNICAL_ERROR:"Une erreur est survenue, merci de r\xe9essayer"},le=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).signup=a.signup.bind(Object(S.a)(a)),a.login=a.login.bind(Object(S.a)(a)),a.state={isLoading:!1},a}return Object(d.a)(n,[{key:"signup",value:function(e){var t=this;return this.setState({isLoading:!0,form:e}),y.signUp(e).then((function(){t.setState({isAccountCreated:!0,isLoading:!1})})).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.error,a=void 0===n?"TECHNICAL_ERROR":n;t.setState({error:a,isLoading:!1})}))}},{key:"login",value:function(){var e=this;return this.setState({isLoading:!0}),y.login(this.state.form).then((function(){e.props.history.replace(de.DASHBOARD.path)}))}},{key:"render",value:function(){var e=this;return this.state.isLoading?Object(R.jsx)(P,{}):Object(R.jsx)("div",{className:"authent-page",children:Object(R.jsx)("div",{className:"authent-page__form-container",children:Object(R.jsx)(Q.b,{onSubmit:this.signup,render:function(t){var n=t.handleSubmit;return e.state.isAccountCreated?Object(R.jsxs)(s.a.Fragment,{children:[Object(R.jsxs)("div",{className:"authent-page__account-created",children:["Bienvenue dans la commu ",e.state.form.username," !"]}),Object(R.jsx)("button",{onClick:e.login,children:"Se connecter"})]}):Object(R.jsxs)("form",{onSubmit:n,autoComplete:"off",children:[Object(R.jsx)(Q.a,{name:"email",validate:ne(ae,se(te)),children:function(e){var t=e.input;return Object(R.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"email",placeholder:"Email",name:"email"}))}}),Object(R.jsx)(Q.a,{name:"username",validate:ne(ae),children:function(e){var t=e.input;return Object(R.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"text",placeholder:"Username",name:"username"}))}}),Object(R.jsx)(Q.a,{name:"password",validate:ne(ae,re),children:function(e){var t=e.input;return Object(R.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"password",placeholder:"Mot de passe",name:"password"}))}}),Object(R.jsxs)("div",{className:"form-error-message",children:[Object(R.jsx)(ee,{name:"email",when:["required"],message:"L'email est requis"}),Object(R.jsx)(ee,{name:"email",when:["pattern"],message:"Le format de l'email renseign\xe9 est incorrect"}),Object(R.jsx)(ee,{name:"password",when:["required"],message:"Le mot de passe est requis"}),Object(R.jsx)(ee,{name:"password",when:["passwordLength"],message:"Le mot de passe doit faire au moins 9 caract\xe8res"}),e.state.error&&Object(R.jsx)("span",{children:oe[e.state.error]})]}),Object(R.jsx)("button",{type:"submit",children:"Rejoindre la communaut\xe9"})]})}})})})}}]),n}(a.Component),de={HOME:{path:"/",exact:!0,component:G((function(e){return e.history.replace(de.DASHBOARD.path),null}))},LOGIN:{path:"/login",component:ie},SIGNUP:{path:"/signup",component:le},DASHBOARD:{path:"/dashboard",component:G((function(e){return console.log("props",e)||Object(R.jsxs)("div",{className:"page",children:[Object(R.jsx)("div",{className:"page__header",children:Object(R.jsx)("div",{className:"page__header-col",children:"Dashboard"})}),Object(R.jsx)("div",{className:"page__content",children:"Content here"})]})}))},DECKS:{path:"/decks",component:function(){return Object(R.jsx)(s.a.Fragment,{children:Object(R.jsxs)("div",{className:"page",children:[Object(R.jsx)("div",{className:"page__header",children:Object(R.jsx)("div",{className:"page__header-col",children:"2021-05-12"})}),Object(R.jsx)("div",{className:"page__content",children:C.a.values(Y).map((function(e,t){return Object(R.jsx)(b.a,{path:e.path,exact:e.exact,render:function(t){return Object(R.jsx)(e.component,Object(o.a)({},t))}},t)}))})]})})}}},ue=(n(78),function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this)).state={isLoading:!0,isMenuToggled:!1},e.toggleMenu=e.toggleMenu.bind(Object(S.a)(e)),e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;U.getSelfUser().then((function(t){e.setState({user:t,isLoading:!1})}))}},{key:"toggleMenu",value:function(){this.setState({isMenuToggled:!this.state.isMenuToggled})}},{key:"render",value:function(){return this.state.isLoading?Object(R.jsx)("div",{children:"isLoading ..."}):Object(R.jsxs)(s.a.Fragment,{children:[Object(R.jsx)("div",{className:"sidebar__toggle-menu",onClick:this.toggleMenu}),Object(R.jsxs)("div",{className:h()("sidebar",{"sidebar--toggled":this.state.isMenuToggled}),children:[Object(R.jsxs)("div",{className:"sidebar__user-card",children:[Object(R.jsx)("div",{className:"sidebar__close-menu",onClick:this.toggleMenu}),Object(R.jsx)("div",{className:"sidebar__user-name",children:this.state.user.pseudo}),Object(R.jsx)("div",{className:"sidebar__user-informations",children:Object(R.jsxs)("div",{className:"sidebar__user-informations-row",children:[Object(R.jsx)("span",{className:"sidebar__user-informations-value",children:"#7500"}),Object(R.jsx)("span",{className:"sidebar__user-informations-trend sidebar__user-informations-trend--up",children:"+497"})]})})]}),Object(R.jsxs)("nav",{children:[Object(R.jsxs)(i.c,{to:de.DASHBOARD.path,className:"sidebar__item",activeClassName:"sidebar__item--selected",onClick:this.toggleMenu,children:[Object(R.jsx)("div",{className:"sidebar__item-icon sidebar__item-icon--dashboard"}),Object(R.jsx)("span",{className:"sidebar__item-label",children:"Tableau de bord"})]}),Object(R.jsxs)(i.c,{to:V.HOME,className:"sidebar__item",activeClassName:"sidebar__item--selected",onClick:this.toggleMenu,children:[Object(R.jsx)("div",{className:"sidebar__item-icon sidebar__item-icon--decks"}),Object(R.jsx)("span",{className:"sidebar__item-label",children:"Mes decks"})]}),this.state.user.teamId&&Object(R.jsxs)(i.c,{to:de.TEAM.path,className:"sidebar__item",activeClassName:"sidebar__item--selected",onClick:this.toggleMenu,children:[Object(R.jsx)("div",{className:"sidebar__item-icon sidebar__item-icon--team"}),Object(R.jsx)("span",{className:"sidebar__item-label",children:"Mon \xe9quipe"})]})]})]})]})}}]),n}(s.a.Component)),je=Object(b.e)(ue),me=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(d.a)(n,[{key:"render",value:function(){return Object.values(de).map((function(e,t){return Object(R.jsx)(b.a,{path:e.path,exact:e.exact,render:function(t){return Object(R.jsxs)("div",{className:h()("app-layout",{"app-layout--extended":!y.isAuthenticated()}),children:[y.isAuthenticated()&&Object(R.jsx)(je,{}),Object(R.jsx)(e.component,Object(o.a)({},t))]})}},t)}))}}]),n}(s.a.Component);c.a.render(Object(R.jsx)(i.a,{children:Object(R.jsx)(me,{})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.da61b93a.chunk.js.map