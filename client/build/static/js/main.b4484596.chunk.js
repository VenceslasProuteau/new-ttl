(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{58:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),c=n(32),r=n.n(c),u=n(20),o=n(3),s=n(5),l=n(6),h=n(14),j=n(13),p=n(4),b=n(2),O=n(12),d=n(15),m=n.n(d),f=n(33),v=n.n(f),g=new(function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"getAuthToken",value:function(){return m.a.get("authToken")}}]),e}()),x=new(function(){function e(t){Object(s.a)(this,e),this.AuthTokenService=t}return Object(l.a)(e,[{key:"call",value:function(e){return v()(Object(o.a)(Object(o.a)({},e),{},{url:"".concat("/api/v1").concat(e.url),method:e.method||"GET"})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}))}},{key:"callAuth",value:function(e){var t=this;return this.AuthTokenService.getAuthToken().then((function(n){return t.call(Object(o.a)(Object(o.a)({},e),{},{headers:Object(o.a)(Object(o.a)({},e.headers),{},{token:n})}))}))}}]),e}())(g),y=new(function(){function e(t){Object(s.a)(this,e),this.ApiService=t}return Object(l.a)(e,[{key:"login",value:function(e){return this.ApiService.call({method:"POST",url:"/user/login",data:e})}},{key:"signUp",value:function(e){return this.ApiService.call({method:"POST",url:"/user/signup",data:e})}}]),e}())(x),k="authToken",A=function(){function e(){Object(s.a)(this,e),this.clientCache={}}return Object(l.a)(e,[{key:"get",value:function(){return this.clientCache}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.clientCache=Object(o.a)(Object(o.a)({},this.clientCache),e)}},{key:"reset",value:function(){this.clientCache={}}}]),e}(),S=new(function(){function e(t){Object(s.a)(this,e),this.AuthApi=t,this.store=new A}return Object(l.a)(e,[{key:"getDomain",value:function(){window.location.hostname.split(".").slice(-2).join(".")}},{key:"logout",value:function(){var e=this.getDomain();m.a.remove(k,{domain:e}),this.store.reset()}},{key:"login",value:function(e){var t=this;return this.AuthApi.login(e).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.data.token;m.a.set(k,n,{expires:30,domain:t.getDomain()})}))}},{key:"signUp",value:function(e){var t=this;return this.AuthApi.signUp(e).then((function(){return t.login(e)}))}},{key:"isAuthenticated",value:function(){return!!m.a.get(k)}}]),e}())(y),w=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"onLogin",value:function(e){var t=this;return S.login(e).then((function(){return t.props.history.replace(D.DASHBOARD.path)})).catch((function(e){return console.log("err")}))}},{key:"render",value:function(){return Object(b.jsx)("div",{className:"login",children:Object(b.jsx)(O.b,{onSubmit:this.onLogin,render:function(e){var t=e.handleSubmit;return Object(b.jsxs)("form",{onSubmit:t,autoComplete:"off",children:[Object(b.jsx)(O.a,{name:"email",children:function(e){var t=e.input;return Object(b.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"email",placeholder:"Email",name:"email"}))}}),Object(b.jsx)(O.a,{name:"password",children:function(e){var t=e.input;return Object(b.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"password",placeholder:"Mot de passe",name:"password"}))}}),Object(b.jsx)("input",{type:"submit",label:"Se connecter"})]})}})})}}]),n}(a.Component),C=n(17),D={HOME:{path:"/",exact:!0,component:function(e){return e.history.replace(D.LOGIN.path),null}},LOGIN:{path:"/login",component:w},SIGNUP:{path:"/signup",component:function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).signup=a.signup.bind(Object(C.a)(a)),a}return Object(l.a)(n,[{key:"signup",value:function(e){var t=this;return this.setState({isLoading:!0}),S.signUp(e).then((function(){return t.props.history.replace(D.DASHBOARD.path)})).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.errors,a=void 0===n?[]:n;t.setState({errors:a,isLoading:!1})}))}},{key:"render",value:function(){return Object(b.jsx)("div",{className:"signup",children:Object(b.jsx)(O.b,{onSubmit:this.signup,render:function(e){var t=e.handleSubmit;return Object(b.jsxs)("form",{onSubmit:t,autoComplete:"off",children:[Object(b.jsx)(O.a,{name:"email",children:function(e){var t=e.input;return Object(b.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"email",placeholder:"Email",name:"email"}))}}),Object(b.jsx)(O.a,{name:"username",children:function(e){var t=e.input;return Object(b.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"text",placeholder:"Username",name:"username"}))}}),Object(b.jsx)(O.a,{name:"password",children:function(e){var t=e.input;return Object(b.jsx)("input",Object(o.a)(Object(o.a)({},t),{},{type:"password",placeholder:"Mot de passe",name:"password"}))}}),Object(b.jsx)("input",{type:"submit",value:"Cr\xe9er mon compte"})]})}})})}}]),n}(a.Component)},DASHBOARD:{path:"/dashboard",component:function(){return Object(b.jsx)("div",{children:"Dashboard"})}}},T=(n(58),function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsxs)(i.a.Fragment,{children:[Object(b.jsx)("div",{className:"app__menu-toggle"}),Object(b.jsx)("div",{className:"app",children:Object(b.jsx)("div",{className:"layout-container",children:Object.values(D).map((function(e,t){return Object(b.jsx)(p.a,{path:e.path,exact:e.exact,render:function(t){return Object(b.jsx)(e.component,Object(o.a)({},t))}},t)}))})})]})}}]),n}(i.a.Component));r.a.render(Object(b.jsx)(u.a,{children:Object(b.jsx)(T,{})}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.b4484596.chunk.js.map